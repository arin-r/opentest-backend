import mongoose, { Schema, model, models, Model } from "mongoose";

type TestType = "jee-main" | "jee-adv";
type TestInfo = {
  name: string;
  hexId: string;
  testType: TestType;
  // TODO: fix type
  givenBy: mongoose.Types.ObjectId[];
  questions: mongoose.Types.ObjectId[];
};

const testSchema = new Schema<TestInfo>({
  name: {
    type: String,
    required: true,
  },
  hexId: {
    type: String,
    required: true,
    unique: true,
  },
  testType: {
    type: String,
    required: true,
  },
  //TODO: instead of storing givenBy I should store _id of sessions of this test
  givenBy: [{ type: Schema.Types.ObjectId, ref: "User" }],
  questions: [
    {
      type: Schema.Types.ObjectId,
      ref: "Question",
    },
  ],
});

export default (models.Test as Model<TestInfo>) || model("Test", testSchema);
